name: 'Terraform GitHub Action'
on:
    pull_request:
        branches:
            - main
    workflow_dispatch:

jobs:
    terraform:
        name: 'Terraform'
        runs-on: ubuntu-latest
        steps:
            - name: 'Checkout'
              uses: actions/checkout@v2

            - name: 'Setup Terraform'
              uses: hashicorp/setup-terraform@97f030cf6dc0b4f5e0da352c7bca9cca34579800

            - name: 'Terraform Format'
              id: fmt
              run: terraform fmt -check

            - name: 'Terraform Init'
              id: init
              run: terraform init

            - name: 'Terraform Validate'
              id: validate
              run: terraform validate -no-color

            - name: 'Terraform Plan'
              id: plan
              run: terraform plan -no-color